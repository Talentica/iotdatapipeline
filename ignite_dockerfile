FROM java:alpine
RUN mkdir application
RUN apk --no-cache add curl
COPY ssl/nexus.crt application
RUN curl --cacert application/nexus.crt  -X GET  "https://172.19.103.71:8443/nexus/repository/nexus/IgniteSparkIOT-0.0.1-SNAPSHOT.jar" -o application/ignite.jar &&\
    curl --cacert application/nexus.crt  -X GET  "https://172.19.103.71:8443/nexus/repository/config_files/ignite-config.xml" -o application/ignite-config.xml &&\
    rm application/nexus.crt
WORKDIR application
CMD ["java","-cp","ignite.jar", "-Dtarget_env=development", "-Dmongodb.url=mongo", "-Dbroker.url=tcp://EMQ:1883", "-Dtopic=temperature", "-Xms512m", "-Xmx512m", "com.talentica.iot.SparkStreamerApplication","mongo"]
